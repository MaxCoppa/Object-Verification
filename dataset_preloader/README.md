# Dataset Preloader

This submodule provides custom PyTorch Dataset classes for **Object Verification**.  
It supports loading image pairs or triplets for both **training** and **evaluation**, based on preprocessed annotation CSVs.

---

## Classes

### `VeriImageDataset`

Dataset class for **training** Siamese networks. Supports sampling positive and negative pairs (or triplets) according to the annotations.

**Constructor Arguments:**

| Argument | Type | Description |
|----------|------|-------------|
| `annotations_file` | str | Path to CSV containing preprocessed annotations. |
| `correct_pair_ratio` | float | Probability of sampling a positive pair in triplet mode (default: 0.5). |
| `img_dir` | str or None | Optional base directory for images. |
| `train` | bool | Whether to load training data (`True`) or test data (`False`). |
| `transform` | callable | Optional torchvision transform(s) to apply to images. |
| `file_type` | str | Type of image file (`"jpg"`, `"png"`, etc.). Default: `"jpg"`. |
| `pairing_type` | str | Pairing mode: `"couples"` for image pairs, `"triplets"` for triplet generation. |
| `crop_type` | str or None | Optional crop method to apply if images require cropping. |

**Output Format:**

Each item returned by the dataset:

```python
(image_tensor, couple_tensor, label)
````

* `image_tensor`: First image tensor.
* `couple_tensor`: Second image tensor.
* `label`: `1` for positive pair, `0` for negative pair.

**Additional Features:**

* Supports triplet-based sampling for advanced training strategies.
* Optional cropping and custom image transforms.
* Visualization utility to inspect training image pairs.

---

### `VeriImageDatasetTest`

Dataset class for **evaluation/testing**. Loads image pairs along with their labels and paths.

**Constructor Arguments:**

| Argument           | Type        | Description                                                    |
| ------------------ | ----------- | -------------------------------------------------------------- |
| `annotations_file` | str         | Path to CSV containing preprocessed annotations.               |
| `img_dir`          | str or None | Optional base directory for images.                            |
| `transform`        | callable    | Optional torchvision transform(s) to apply to images.          |
| `file_type`        | str         | Type of image file (`"jpg"`, `"png"`, etc.). Default: `"jpg"`. |
| `crop_type`        | str or None | Optional crop method to apply if images require cropping.      |

**Output Format:**

Each item returned by the dataset:

```python
(image_tensor, couple_tensor, label, image_path, couple_path)
```

* `image_tensor`: First image tensor.
* `couple_tensor`: Second image tensor.
* `label`: `1` for positive pair, `0` for negative pair.
* `image_path`: File path of the first image.
* `couple_path`: File path of the second image.

**Additional Features:**

* Ensures full traceability of images during evaluation.
* Optional cropping and transform support.
* Visualization utility to inspect test image pairs.

---

## Notes

* Both classes rely on preprocessed annotation CSVs generated by the `dataset_annotation_preparation` submodule.
* Designed for compatibility with the Siamese network training and evaluation pipelines.
* Supports flexible transformations and cropping strategies for both training and testing.


