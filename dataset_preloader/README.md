# Dataset Preloader

The **Dataset Preloader** module defines custom PyTorch `Dataset` classes for the Object Verification pipeline.  
It provides a clean interface to load image pairs or triplets from preprocessed annotations, supporting both **training** and **evaluation**.

---

## VeriImageDataset

A `torch.utils.data.Dataset` for **training Siamese networks**.  
Samples positive and negative pairs (or triplets) according to the annotation file.

### Parameters

- `annotations_file` (*str*): Path to the preprocessed annotations CSV.  
- `correct_pair_ratio` (*float, default=0.5*): In triplet mode, probability of sampling a positive pair.  
- `train` (*bool, default=True*): Load the training subset (`True`) or the test subset (`False`).  
- `transform` (*callable or None*): Torchvision transform(s) applied to images.  
- `pairing_type` (*str, default="couples"*): Sampling strategy â€” `"couples"` for pairs or `"triplets"` for triplets.
Here `file_type`, `crop_type` not used for the moment (emphasize that)
- `file_type` (*str, default="jpg"*): Image format (e.g. `"jpg"`, `"png"`).  
- `crop_type` (*str or None*): Cropping strategy applied to images, if available.  

### Returns

Each dataset item is a tuple:  

- `image_tensor`: Tensor of the first image.  
- `couple_tensor`: Tensor of the paired image (positive or negative).  
- `label`: `1` if both images belong to the same object, `0` otherwise.  

---

## VeriImageDatasetTest

A `torch.utils.data.Dataset` for **evaluation and testing**.  
Extends `VeriImageDataset` by also returning file paths for traceability.

### Parameters

- `annotations_file` (*str*): Path to the preprocessed annotations CSV.  
- `transform` (*callable or None*): Torchvision transform(s) applied to images.  
Here `file_type`, `crop_type` not used for the moment (emphasize that)

- `file_type` (*str, default="jpg"*): Image format (e.g. `"jpg"`, `"png"`).  
- `crop_type` (*str or None*): Cropping strategy applied to images, if available.  

### Returns

Each dataset item is a tuple:  

- `image_tensor`: Tensor of the first image.  
- `couple_tensor`: Tensor of the paired image.  
- `label`: `1` for a positive pair, `0` for a negative pair.  
- `image_path`: Path to the first image file.  
- `couple_path`: Path to the second image file.  

---

## Expected Annotation Schema

Both datasets rely on CSV files generated by the **dataset annotation preparation** module.  


## Integration Notes

- Designed to plug directly into `torch.utils.data.DataLoader` for efficient batching.  
- Consumes the CSV annotations prepared by the **dataset annotation preparation** module.  
- Ensures full compatibility with the **training** and **evaluation** pipelines for Siamese models.  
- Flexible enough to support different pairing strategies, transforms, and cropping workflows.  
